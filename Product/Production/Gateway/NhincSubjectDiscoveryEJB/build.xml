<?xml version="1.0" encoding="UTF-8"?>
<!-- You may freely edit this file. See commented blocks below for -->
<!-- some examples of how to customize the build. -->
<!-- (If you delete it and reopen the project it will be recreated.) -->
<project name="NhincSubjectDiscoveryEJB" default="default" basedir="." xmlns:ejbjarproject="http://www.netbeans.org/ns/j2ee-ejbjarproject/3">
    <description>Builds, tests, and runs the project NhincSubjectDiscoveryEJB.</description>
    <import file="nbproject/build-impl.xml"/>

    <property name="deploy.type" value="ejb" />
    <property name="deploy.isDeployable" value="true"/>

	<import file="../../../build.lib.xml" />

	<target name="build">
		<property name="target-to-call" value="dist" />
		<antcall target="call-target-in-isolation-if-out-of-date" />
	</target>
	<target name="clean-build" depends="clean,dist" />
	<target name="clean-test" depends="clean,dist" />
	<target name="build-test" depends="dist" />		
    
     <!-- Had to pull this out of jaxws-build.xml because it copied the wsdl, but for some reason it 
         did not copy the schemas.  We have to copy the schemas ourselves or it will not deploy.  -->
    <target name="wsimport-service-SubjectDiscovery" depends="wsimport-init">
<!--
        <wsimport xendorsed="true" sourcedestdir="${build.generated.dir}/wsimport/service" extension="true" verbose="true" destdir="${build.generated.dir}/wsimport/binaries" wsdl="${basedir}/${meta.inf}/xml-resources/web-services/SubjectDiscovery/wsdl/NhinSubjectDiscovery.wsdl" catalog="catalog.xml"/>
-->
        <echo message="copy wsdl's" />        
        <copy todir="${basedir}/${meta.inf}/wsdl/SubjectDiscovery">
            <fileset dir="${basedir}/${meta.inf}/xml-resources/web-services/SubjectDiscovery/wsdl/"/>
        </copy>
        
        <echo message="copy schemas" />
        <copy todir="${basedir}/${meta.inf}/wsdl/schemas/">
            <fileset dir="${basedir}/${meta.inf}/xml-resources/web-services/SubjectDiscovery/schemas/" />
        </copy>
    </target>  

    <target depends="compile" name="library-inclusion-in-archive">
        <copy file="${file.reference.NhincSamlTokenLib.jar}" todir="${build.classes.dir}"/>
        <copy file="${file.reference.GatewayInternalComponentProxy.jar}" todir="${build.classes.dir}"/>
        <copy file="${file.reference.AdapterMpiProxy.jar}" todir="${build.classes.dir}"/>
        <copy file="${file.reference.AdapterMpiProxyImpl.jar}" todir="${build.classes.dir}"/>
        <copy file="${file.reference.PatientCorrelationFacade.jar}" todir="${build.classes.dir}"/>
        <copy file="${file.reference.PatientCorrelationFacadeProxy.jar}" todir="${build.classes.dir}"/>
        <copy file="${file.reference.NhinServiceProxy.jar}" todir="${build.classes.dir}"/>
        <copy file="${file.reference.AdapterReidentificationProxy.jar}" todir="${build.classes.dir}"/>
        <copy file="${file.reference.AdapterReidentificationProxyImpl.jar}" todir="${build.classes.dir}"/>
        <copy file="${file.reference.AdapterServiceProxy.jar}" todir="${build.classes.dir}"/>
    </target>
    <target depends="compile" name="library-inclusion-in-manifest">
        <basename file="${file.reference.NhincSamlTokenLib.jar}" property="included.lib.file.reference.NhincSamlTokenLib.jar"/>
        <copy file="${file.reference.NhincSamlTokenLib.jar}" todir="${dist.ear.dir}"/>
        <basename file="${file.reference.NhincLib.jar}" property="included.lib.file.reference.NhincLib.jar"/>
        <copy file="${file.reference.NhincLib.jar}" todir="${dist.ear.dir}"/>
        <basename file="${file.reference.GatewayInternalComponentProxy.jar}" property="included.lib.file.reference.GatewayInternalComponentProxy.jar"/>
        <copy file="${file.reference.GatewayInternalComponentProxy.jar}" todir="${dist.ear.dir}"/>
        <basename file="${file.reference.NhincDataTransformsLib.jar}" property="included.lib.file.reference.NhincDataTransformsLib.jar"/>
        <copy file="${file.reference.NhincDataTransformsLib.jar}" todir="${dist.ear.dir}"/>
        <basename file="${file.reference.AssigningAuthoritiesToHomeCommunityMappingDAO.jar}" property="included.lib.file.reference.AssigningAuthoritiesToHomeCommunityMappingDAO.jar"/>
        <copy file="${file.reference.AssigningAuthoritiesToHomeCommunityMappingDAO.jar}" todir="${dist.ear.dir}"/>
        <basename file="${file.reference.AdapterMpiProxy.jar}" property="included.lib.file.reference.AdapterMpiProxy.jar"/>
        <copy file="${file.reference.AdapterMpiProxy.jar}" todir="${dist.ear.dir}"/>
        <basename file="${file.reference.AdapterMpiProxyImpl.jar}" property="included.lib.file.reference.AdapterMpiProxyImpl.jar"/>
        <copy file="${file.reference.AdapterMpiProxyImpl.jar}" todir="${dist.ear.dir}"/>
        <basename file="${file.reference.PatientCorrelationFacade.jar}" property="included.lib.file.reference.PatientCorrelationFacade.jar"/>
        <copy file="${file.reference.PatientCorrelationFacade.jar}" todir="${dist.ear.dir}"/>
        <basename file="${file.reference.PatientCorrelationFacadeProxy.jar}" property="included.lib.file.reference.PatientCorrelationFacadeProxy.jar"/>
        <copy file="${file.reference.PatientCorrelationFacadeProxy.jar}" todir="${dist.ear.dir}"/>
        <basename file="${file.reference.NhinServiceProxy.jar}" property="included.lib.file.reference.NhinServiceProxy.jar"/>
        <copy file="${file.reference.NhinServiceProxy.jar}" todir="${dist.ear.dir}"/>
        <basename file="${file.reference.AdapterReidentificationProxy.jar}" property="included.lib.file.reference.AdapterReidentificationProxy.jar"/>
        <copy file="${file.reference.AdapterReidentificationProxy.jar}" todir="${dist.ear.dir}"/>
        <basename file="${file.reference.AdapterReidentificationProxyImpl.jar}" property="included.lib.file.reference.AdapterReidentificationProxyImpl.jar"/>
        <copy file="${file.reference.AdapterReidentificationProxyImpl.jar}" todir="${dist.ear.dir}"/>
        <basename file="${file.reference.AdapterServiceProxy.jar}" property="included.lib.file.reference.AdapterServiceProxy.jar"/>
        <copy file="${file.reference.AdapterServiceProxy.jar}" todir="${dist.ear.dir}"/>
        <manifest file="${build.ear.classes.dir}/META-INF/MANIFEST.MF" mode="update">
            <attribute name="Class-Path" value="${included.lib.file.reference.NhincSamlTokenLib.jar} ${included.lib.file.reference.GatewayInternalComponentProxy.jar} ${included.lib.file.reference.AdapterMpiProxy.jar} ${included.lib.file.reference.AdapterMpiProxyImpl.jar} ${included.lib.file.reference.PatientCorrelationFacade.jar} ${included.lib.file.reference.PatientCorrelationFacadeProxy.jar} ${included.lib.file.reference.NhinServiceProxy.jar} ${included.lib.file.reference.AdapterReidentificationProxy.jar} ${included.lib.file.reference.AdapterReidentificationProxyImpl.jar} ${included.lib.file.reference.AdapterServiceProxy.jar}"/>
        </manifest>
    </target>   
	<target depends="init" if="netbeans.home" name="undeploy-clean" unless="from.commandline">
        <nbundeploy failOnError="false" startServer="false"/>
    </target>
</project>
